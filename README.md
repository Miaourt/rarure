Here's the RaRuRe's sources, I might put more details on how it work later.